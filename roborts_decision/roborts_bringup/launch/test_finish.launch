<launch>
    <!-- 需要在妙算上先开启lidar.launch 和 roborts_bringup 中的base.launch -->
    <!-- these are the arguments you can pass this launch file, for example gui:=true -->
    <arg name="paused" default="false"/>
    <arg name="use_sim_time" default="true"/>
    <arg name="gui" default="true"/>
    <arg name="headless" default="false"/>
    <arg name="debug" default="false"/>
    <arg name="map" value="b3_4_finish"/>
    <arg name="ns"                        default="red1"/>

   <!-- launch the transform node  用于键盘控制 -->
    <include file="$(find icra_robomaster_emulator)/launch/transform_red1.launch"/>

    <!-- 启动rviz -->
    <node pkg="rviz" type="rviz" name="rviz" args="-d $(find icra_robomaster_emulator)/rviz/red1.rviz"/>


   <group ns="red1">

    	 <param name="tf_prefix" value="red1"/>
   	 <rosparam command="load" file="$(find roborts_localization)/config/localization.yaml" />
   	 <rosparam command="load" file="$(find roborts_localization)/amcl/config/amcl.yaml" />

   	 <!-- Run the map server -->
   	 <node name="map_server" pkg="map_server" type="map_server" args="$(find icra_robomaster_emulator)/map/$(arg map).yaml" respawn="false"  />


  	<!-- Run the global planner node -->
  	<node pkg="roborts_planning" type="global_planner_node" name="global_planner_node" respawn="false" />



  	<!-- Run the local planner node -->
	<!-- 在local_planner_node.cpp中初始化成了“red1/odom” -->
  	<node pkg="roborts_planning" type="local_planner_node" name="local_planner_node" respawn="false" output="screen" >
    	<remap from="/local_planner_node_action/feedback"           to="/$(arg ns)/local_planner_node_action/feedback" />
    	<remap from="/local_planner_node_action/result"             to="/$(arg ns)/local_planner_node_action/result" />
   	 <remap from="/local_planner_node_action/status"             to="/$(arg ns)/local_planner_node_action/status" />
   	 <remap from="/local_planner_node_action/goal"               to="/$(arg ns)/local_planner_node_action/goal" />
   	 <remap from="/local_planner_node_action/cancel"             to="/$(arg ns)/local_planner_node_action/cancel" />
  	</node>

	
	<!-- Run the localization node -->
	<!-- 在localization config中初始化成了“red1”的坐标系 -->
  	<node pkg="roborts_localization" type="localization_node" name="localization_node" respawn="false" />
	
	<!-- Run the static tf -->
    	<include file="$(find roborts_bringup)/launch/static_tf.launch"/>
	





    </group>





</launch>
